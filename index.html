<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>약품 바코드 스캐너 테스트</title>
    <script src="https://unpkg.com/html5-qrcode"></script>
    <style>
        body { font-family: sans-serif; text-align: center; padding: 20px; }
        #reader { width: 100%; max-width: 500px; margin: 0 auto; }
        #result { margin-top: 20px; padding: 15px; border: 2px solid #ddd; font-size: 1.2rem; word-break: break-all; }
        .success { border-color: #4CAF50 !important; background-color: #e8f5e9; }
    </style>
</head>
<body>
    <h2>바코드 스캔 테스트</h2>
    <div id="reader"></div>
    <div id="result">여기에 스캔 결과가 표시됩니다.</div>

    <script>
        function onScanSuccess(decodedText, decodedResult) {
            // 스캔 성공 시 처리
            const resultElement = document.getElementById('result');
            resultElement.innerText = `스캔 성공: ${decodedText}`;
            resultElement.classList.add('success');
            
            console.log(`Code matched = ${decodedText}`, decodedResult);
            
            // 필요하다면 여기서 진동이나 소리 추가 가능
            window.navigator.vibrate(100); 
        }

        function onScanFailure(error) {
            // 스캔 실패(바코드가 화면에 없거나 흐릴 때)는 로그를 찍지 않는 것이 성능에 좋음
        }

        let html5QrcodeScanner = new Html5QrcodeScanner(
            "reader", 
            { 
                fps: 10, 
                qrbox: {width: 250, height: 250},
                // Data Matrix와 Code 39를 모두 인식하도록 설정
                formatsToSupport: [ 
                    Html5QrcodeSupportedFormats.DATA_MATRIX, 
                    Html5QrcodeSupportedFormats.CODE_39 
                ]
            },
            /* verbose= */ false);
        html5QrcodeScanner.render(onScanSuccess, onScanFailure);
    </script>
</body>
</html>